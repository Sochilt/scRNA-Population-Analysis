# scRNA-Population-Analysis
The purpose of this analysis is to determine what populations are present, specifically in a microenvironment for scRNA-seq data.
The code is based around Seurat with addtional computational analysis for deeper insights. File used for tertiary scRNA analysis is a filtered feature_bc_matrix file ('bc' stands for barcode). 
This file is a sparse counts matrix file of gene expression data of a subset of barcodes identified as corresponding to actual cells.
This is the file that stores gene expression counts based on UMIs (unique molecular identifiers).
```r
# Call in necessary libraries that provide pre-written, reusable functions and tools to do job.
library(dplyr)
library(Seurat)
library(patchwork)
library(readr)
library(rhdf5)
```
Ensure you set your working directory to where you have the "filtered_feature_bc_matrix" files stored.

```r
# Set working directory to where your files are. Be sure to include " " in the code below. 'data' now becomes that pathway. Do this for each matrix file (data, data1, data2...)
setwd("/home/user/documents")
data <- "/home/user/documents/sampleID/filtered_feature_bc_matrix"
```

The filtered_feature_bc_matrix contains files like barcodes.tsv.gz, features.tsv.gz, and matrix.mtx.gz, generated by 10X Genomics' Cell Ranger pipeline.
Read this pathway in.  I usually name the new directory as the sample ID.
```r
# Example
CLL1234 <- Read10X(data)
CLL5678 <- Read10X(data1)

# If your file is an .h5 file then use Read10X_h5. Ex: CLL1234 <- Read10X_h5(data)
```
Now you want to create the Seurat object from this count matrix.  A "Seurat object" is designed for scRNA-seq analysis that stores multiple types of data.
Types of data stored in this object: expression matrix (genes vs. cells), metadata(e.g., cell annotations), analysis results (e.g., clustering, dimensionality reduction).

```r
# Creating the Seurat object.
> C1234 <- CreateSeuratObject(counts = CLL1234, project = "CLL1234", min.cells = 3)
```

An additional variable can be added when creating the Seurat object, known as, minimum features.  This will typically be 'min.features =200'.
Why would we have a "minimum features" filter?  We use "minimum features" because low-quality cells or empty droplets will often have very few genes (features).
We want to try to eliminate low quality cells. However, aberrantly high gene counts may be due to doublets and we can set the min.features <2,500. 
To include "minimum features" filer:
```r
C1234 <- CreateSeuratObject(counts = CLL1234, project = "CLL1234", min.cells = 3, min.features = 200)
# Then subset to keep cells with feature counts < 2,500
C1234 <- subset(C1234, subset = nFeature_RNA > 200 & nFeature_RNA < 2500)
```





